function LEI(){this.ver="0.1",this.css='#LEIMainTable {		    background-color: #323336;		    padding: 0px;		    margin: 0px;		    border:none;			}						#LEImainDiv table{				width:100%;			}			#LEIMainTitleTable{		    background-color: #323336;		    padding: 0px;		    margin: 0px;		    border:none;			}						#LEIMainTable img{			    display: inline;			}						#LEIMainTable td{			    padding: 0px 5px 0px 5px;			    margin: 0px;			    vertical-align:middle;			}						#emtDebugTopLeft {			    background: transparent url(http://lpdevnew/training/emtdebuglib/images/topBarStart.png) no-repeat scroll left top;			    width: 6px;			}						#emtDebugLogo {			    background: #323336 url("https://z1-a.le.liveperson.net/assets/img/100x100-sprite.png") -118px -12px no-repeat;			    width: 85px;			}						#LEIMainTitle {			    background: #323336;			    color: #fff !important;			    cursor: move;			    font-family: "Myriad pro", "Trebuchet MS", "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", sans-serif;			    font-size: 12px;			    font-weight: bold;			    padding: 0px;			    margin: 0px;			    white-space: nowrap;			    text-align: center;			    vertical-align: middle; 			}						#LEIMainTitleTable td {			    padding: 0px 3px 0px 3px;			    margin: 0px;    			}						#LEIMinimize {			    background: #323336;			    text-align: right;			    width: 90px;			    padding: 0px;			    margin: 0px;			    vertical-align:middle;			}						#LEIMinimize a {			    cursor: pointer;			    vertical-align: middle;			    padding: 0px;			    margin: 0px;			}			#LEIMinimize img {			    padding-top: 3px;			    display: inline;			}						#LEITopRight {			    background: transparent url(http://lpdevnew/training/emtdebuglib/images/topBarEnd.png) no-repeat scroll right top;			    padding: 0px;			    margin: 0px;			    text-align:right;			    width: 6px;			}						/*  The main monitor window     */			#emtDebugMainMonitorTable {			    background-color: #515254;			    border:none;			    margin:0px;			}						#LEIImgCloseLog {				width: 16px;				height: 16px;			    background: transparent url(https://stoneyshou.github.io/img/sprite.png) -680px -19px no-repeat;			    padding-top: 2px;			    padding-right: 2px;   			}			.LEImainTableTopRow {				background-color:#323336;			    text-align: left;			    font-family: Arial;			    font-size: 12px;						    padding: 3px;			    border-collapse: collapse !important;			    border-spacing: 2px !important;			}						.LEImainTableTopRow td {			    text-align: left;			    font-family: Arial;			    font-size: 14px;						    padding: 3px;			    //border-left: 1px solid #767678;			    border-collapse: collapse !important;			    border-spacing: 2px !important;			    color: #fff;						    vertical-align: middle;			}			.LEIMiniBtn {				width: 16px;				height: 16px;				background: transparent url(https://stoneyshou.github.io/img/sprite.png) -500px 0px no-repeat			}			.LEITagStatNotFound {				width: 16px;				height: 16px;				background: transparent url(https://stoneyshou.github.io/img/sprite.png) -300px 0px no-repeat			}			.LEITagStatOk {				width: 16px;				height: 16px;				background: transparent url(https://stoneyshou.github.io/img/sprite.png) -260px 0px no-repeat			}			.LEITagStatWarn {				width: 16px;				height: 16px;				background: transparent url(https://stoneyshou.github.io/img/sprite.png) -260px -40px no-repeat			}			.LEICloseBtn {				width: 16px;				height: 16px;				background: transparent url(https://stoneyshou.github.io/img/sprite.png) -680px 0px no-repeat			}			.LEIMiniWrapper{				float:right;				margin:0px 4px 0px 4px;			}			.LEIMaxBtn {				width: 16px;				height: 16px;				background: transparent url(https://stoneyshou.github.io/img/sprite.png) -500px 0px no-repeat			}			.LEImainTableTopRowAcc {				background-color: #FF9801;				color: #fff;			}						.LEILable {				text-transform: uppercase;				color: #dcdcdc !important;				font-size: 10px !important;			}						.LEIEMTDivider{				border-right:1px solid #767678;			}			.LEImainTableLabelRow {			    text-align: left;			    font-family: Arial;			    font-size: 12px;							background-color:#515254 !important;			    padding: 1px;			    border-collapse: collapse !important;			    border-spacing: 2px !important;						    vertical-align: middle;			}						.LEImainTableLabelRow td {				text-transform: uppercase;			    text-align: left;			    font-family: Arial;			    font-size: 10px;						    padding: 1px;			    background-color: #515254;			    color: #dcdcdc !important;						    vertical-align: middle;			}						.LEImainTableNumberRow {				background-color:#515254 !important;			    text-align: left;			    font-family: Arial;			    font-size: 12px;						    padding: 3px;			    white-space: nowrap;						    vertical-align: middle;			}						.LEImainTableNumberRow td {			    text-align: left;			    font-family: Arial;			    font-size: 16px;						    padding: 3px;			    white-space: nowrap;			    color: #fff !important;						    vertical-align: middle;			}						.emtDebugInfo {			    cursor: pointer;			}						/* The main Log Window */			#LEIMainLogWindow {			    display: none;			}						#LEILogWindow {			    text-align: left;			    font-family: Arial;			    font-size: 12px;			    border-top: 1px solid #767678;			    background-color: #323336;			}			#LEILogWindow table{				border-collapse:collapse;				border:none;				width: 100%;				text-align:left;			    color: #fff;			}			#LEILogWindow table tr td{			    color: #fff;			}			#LEILogWindow tr:nth-child(2n+1){				background-color: #656568;			}			#LEILogWindow tr:nth-child(2n){				background-color: #5A5B5E;			}						#LEIMessageWindowTitle, #LEIMessageWindowCtrlPanel, #LEIMessageWindowClose{			    text-align: center;			    font-family: "Myriad pro", "Trebuchet MS", "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", sans-serif;			    font-size: 12px;			    color: #fff;			    font-weight: bold;			    background-color:#FF9801;			    border-bottom: 1px solid #767678; 			}						#LEIMessageWindowTitle {			    border-left: 1px solid #767678;			}						#LEIMessageWindowClose {			    border-right: 1px solid #767678;   			}						#LEIMessageWindowClose{			    text-align: right;			    padding:2px;			}						.LEILogMessageDEBUG {			    line-height:12px;			    text-align:left;			    background-color: #515254;			    border: 0px;			    color: dcdcdc;			    font-family: verdana, tahoma, arial, sans-serif;			    white-space: nowrap;			    font-size: 12px;			}						.LEILogMessageOK {			    line-height:12px;			    text-align:left;			    background-color: #515254;			    border: 0px;			    color: green;			    font-family: verdana, tahoma, arial, sans-serif;			    white-space: nowrap;			    font-size: 12px;			}						.LEILogMessageWARN {			    line-height:12px;			    text-align:left;			    background-color: #515254;			    border: 0px;			    color: #FF00FF;			    font-family: verdana, tahoma, arial, sans-serif;			    white-space: nowrap;			    font-size: 12px;			}						.LEILogMessageERROR {			    line-height:12px;			    text-align:left;			    background-color: #515254;			    border: 0px;			    color: red; 			    font-family: verdana, tahoma, arial, sans-serif;			    white-space: nowrap;			    font-size: 12px;			}						/*  The Status Bar */			#LEIMainStatusTable {			    vertical-align: middle;			    border:none;			    margin:0px;			}			#LEIMainStatusTable tr td{			    color:#fff;			}						#LEIStatusLeft {			    background: #323336;			    width: 10px;			    padding: 0;			    vertical-align: middle;			}						#LEIStatusImageTD {			    background: #323336;			    font-family: Arial;			    font-size: 12px;			    color: #fff !important;			    width: 20px;			    vertical-align: middle;			}						#LEIStatusCenter, #LEIStatusProgress, #LEIMsgStatusLogPlayerStatus {			    background: #323336;			    color: #fff !important;			    font-family: Arial;			    font-size: 12px;			    padding: 0;			    white-space: nowrap;			    vertical-align: middle;			}			#LEIMainTable tbody tr{				background-color:#323336;				border:0px none #323336;			}						.LEIStatusBar{				background-color:#323336;				color:#fff !important;			    font-family: Arial;			    font-size: 10px;			    text-align:left;			}			#LEIMsgStatusLogPlayerStatus {			    width: 70px;			    text-align: center;			}			#LEIStatusProgress {			    width: 20px;			    text-align: center;			    vertical-align: middle;			}			#LEIStatusTimeOnPage {			    vertical-align: middle;			}						.LEIStatusDivider {			    background: #323336;			    width: 3px;			}						#LEIImgShowTools{			    background: transparent url(https://stoneyshou.github.io/img/sprite.png) -1100px -20px no-repeat;				width:16px;				height:16px;			}			#LEIImgLog{			    background: transparent url(https://stoneyshou.github.io/img/sprite.png) -1040px -60px no-repeat;				width:16px;				height:16px;			}			.LEITimeIcon{			    background: transparent url(https://stoneyshou.github.io/img/sprite.png) -120px -80px no-repeat;				width:16px;				height:16px;				cursor:pointer;				float:left;				margin:4px 5px 0px 5px;				vertical-align:middle;			}			.LEIFilterIcon{			    background: transparent url(https://stoneyshou.github.io/img/sprite.png) -1780px -20px no-repeat;				width:16px;				height:16px;				float:left;				cursor:pointer;				margin:4px 5px 0px 5px;			}			.LEILogTitle{				vertical-align:middle;				line-height:24px;				height:24px;			}			.LEIStatusResize {			    background: transparent url(https://stoneyshou.github.io/img/sprite.png) -2160px -19px no-repeat;			    padding: 0 !important;			    text-align:right;			    width: 16px;			    cursor: se-resize;			}						.LEIStatusNOResize {			    padding: 0;			    text-align:right;			    width: 25px;			    cursor: default;			}									/* Tools DIV and inside of it */			#LEIToolsDiv {			    position: absolute;			    left: 350px;			    width: auto;			    text-align:left;			    background-color: #323336;			    border: 2px groove #767678;			    font-family: Arial;			    font-size: 12px;			    display: none;			}						#LEIToolsTable td{			    text-align: left;			    font-family: Arial;			    font-size: 12px;			    font-weight: bold;			    color: #fff !important;			    white-space: nowrap;			    cursor: pointer;			    padding: 0px;			    margin: 0px;			}						#LEIToolsTable td a {			    text-align: left;			    font-family: Arial;			    font-weight: bold;			    font-size: 12px;			    color: #fff !important;			    white-space: nowrap;			    text-decoration : none;			}						#LEIEvalInput {			    text-align: left;			    font-family: Arial;			    font-weight: bold;			    font-size: 12px !important;			    color: #fff !important;			    white-space: nowrap;			    height: 35px;			    overflow: auto;			}						.LEIEvalToolBtn {			    text-align: center;			    font-family: Arial;			    font-weight: bold;			    font-size: 12px !important;			    color: #fff !important;			    white-space: nowrap;			    width: 90px;			}						.LEIGeneralInfo th{			    text-align: left;			    font-family: Arial;			    font-size: 12px !important;			    font-weight: bold;						    padding: 3px;			    border-bottom: 1px solid #767678;			    white-space: nowrap;			    vertical-align: top;			}						.LEIGeneralInfo a{			    text-align: left;			    font-family: Arial;			    font-weight: bold;			    font-size: 12px !important;			    color: #fff !important;			    white-space: nowrap;			    text-decoration : underline;			}						.LEIGeneralInfo td{			    text-align: left;			    font-family: Arial;			    font-size: 12px !important;						    padding: 3px;			    border-bottom: 1px solid #767678;			    white-space: nowrap;			}						.LEIHiddenTD {			    text-align: left;			    font-family: Arial;			    font-size: 12px !important;						    padding: 3px;			    border-bottom: 1px solid #767678;			    white-space: nowrap;			    display: none;			}						/* General CSS for error/warn and OK display */			.emtDebugError {			    cursor: pointer;			    background-color: red !important;			}						.emtDebugWarn {			    cursor: pointer;			    background-color: yellow !important;			}						.emtDebugOK{			    background-color: green;			    color: white !important;			}						.emtDebugRedirectString {			    text-align: left;			    font-family: Arial;			    font-size: 12px !important; 			    color:green;			}						#LEIFilterWindow table{			    text-align: left;			    font-family: Arial;			    font-size: 12px !important;			    width : 100%;			    color : #fff;			}			#LEIMainLogWindowTable tbody{				border:none;			}			#LEIMainLogWindowTable {			    border: 0px;			    color:#fff; 			    margin:0px;			}',this.debugCookieName="LP_MTAG_DEBUG_MODE",this.chksiteId="",this.showTimeinLog=!1,this.showLogFilter=!1,this.activeFilter=[],this.msgShown=!1,this.timerPeriod="undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.emtDebugTimerPeriod?1:lpMTagConfig.emtDebugTimerPeriod,this.zindex=2e5,this.logMaxLines="undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.mtagDebugMaxLine?500:lpMTagConfig.mtagDebugMaxLine,"undefined"!=typeof lpMTagConfig&&"undefined"!=typeof lpMTagConfig.emtDebugPosX?this.posX=lpMTagConfig.emtDebugPosX:this.posX=10,this.posY="undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.emtDebugPosY?10:lpMTagConfig.emtDebugPosY,this.logWindowDimensionLimited=!1,this.maxLogWindowMaxHeight=300,this.maxLogWindowMaxWidth=500,this.timestart=new Date,this.debugCookieName="LP_MTAG_DEBUG_MODE",this.debugCookieValue="cK1FoDtP",this.browser="IE",this.noValueStr="-",this.log=[],this.logErr=[],this.logWarn=[],this.eventLog={dynButton:{},invite:{}},this.msgSources={"Not specified":{source:"Not specified"}},this.ude={},this.logShown=!1,this.toolsShown=!1,this.counters={logLine:0,logErr:0,logWarn:0,logOK:0,connPOST:0,connGET:0},this._LOG_PLAY="play",this._LOG_STOP="stop",this._LOG_PAUSE="pause",this._LOG_TRASH="erase",this.logStatus=this._LOG_PLAY,this.logLineCnt=0,this.garbColStrCnt=0,this.progressSymbols=["-","\\","|","/"],this.progressIdx=0,this.evalToolCnt=0,this.leChatProps={numberOfButtons:0,numberOfStickyButtons:0,numberOfInvitations:0,numberOfButtonsInPage:0,numberOfStickyButtonsInPage:0,numberOfInvitationsInPage:0,ver:"",inPagePluginsArr:null,totalPluginsArr:null,engagementType:{button:"button",sticky_button:"sticky_button",invitation:"invitation"},getNumberOfElements:function(t,e){var i=0;if(!lpMTagDebug.leChatRef)return 0;var o=e?lpMTagDebug.leChatRef.inPagePluginsArr:lpMTagDebug.leChatRef.jsonsArr;if("undefined"!=typeof o)for(var n in o)o[n].type===t&&i++;return i}},this.generateHTML=function(){return this.logCtrlPanelHTML="<div id='LEILogPlay'><div id='LEILogPlayImg'></div></div>                                  <div id='LEILogStop'><div id='LEILogStopImg'></div></div>                                  <div id='LEILogErase'><div id='LEILogEraseImg'></div></div>                              ",this.emtHtml="<table id='LEIMainTable' cellspacing='0' cellpadding='0' border='0'>                            <tbody>                                <tr>                                    <td>                                        <table id='LEIMainTitleTable' width='100%' height='26px' cellspacing='0' cellpadding='0' border='0'>                                            <tbody>                                                <tr>                                                    <td id='emtDebugLogo'></td>                                                    <td id='LEIMainTitle'>Inspect Tool ver: "+this.ver+"</td>                                                    <td id='LEIMinimize'>                                                        <div class='LEIMiniWrapper'>                                                        	<a href='javascript:;' alt='Close' title='Close'>                                                            <div id='LEIImgClose' class='LEICloseBtn'></div></a>                                                        </div>                                                        <div class='LEIMiniWrapper'>                                                        	<a href='javascript:;' alt='Minimize / Maximize' title='Minimize / Maximize'>                                                            <div id='LEIImgMinimize' class='LEIMiniBtn'></div></a>                                                        </div>                                                    </td>                                                </tr>                                            </tbody>                                        </table>                                    </td>                                </tr>                                <tr id='LEIMonitorWindow'>                                    <td>                                        <table id='emtDebugMainMonitorTable' width='100%' cellspacing='0' cellpadding='0' border='0'>                                            <tbody>                                                <tr class='LEImainTableTopRow'>                                                	<td></td>                                                    <td colspan='2' class='LEILable'>Account : </td>                                                    <td colspan='2' class='LEImainTableTopRowAcc LEIEMTDivider' id='LEIEMTsiteId'>"+this.noValueStr+"</td>                                                    <td colspan='4' id='LEIDomain' class='LEIEMTDivider'>"+this.noValueStr+"</td>                                                    <td class = 'LEILable'>Section : </td>                                                    <td colspan='4' id='LEIEMTSection' class='LEIEMTDivider'>"+this.noValueStr+"</td>                                                    <td>                                                        <a id='LEIToggleLog' href='javascript:;'>                                                            <div id='LEIImgLog'></div>                                                        </a>                                                    </td>                                                </tr>                                                <tr class='LEImainTableNumberRow'><td style='height:5px'></td></tr>                                                <tr class='LEImainTableNumberRow'>                                                 	<td></td>                                                    <td id='LEIENGcnt' colspan='2'>"+this.noValueStr+"</td>                                                    <td id='LEIEMBcnt' colspan='2'>"+this.noValueStr+"</td>                                                    <td id='LEIClosedcnt' colspan='2'>"+this.noValueStr+"</td>                                                    <td id='LEIENGAtt' colspan='2'>"+this.noValueStr+"</td>                                                    <td id='LEIStatusTimeOnPage' colspan='2'>"+this.noValueStr+"</td>                                                    <td id='LEIERRcnt'>"+this.noValueStr+"</td>                                                    <td id='LEIWARNcnt'>"+this.noValueStr+"</td>                                                    <td class='emtDebugOK' id='LEIOKcnt'>"+this.noValueStr+"</td>                                                </tr>                                               	<tr class='LEImainTableLabelRow'>                                               		<td></td>                                                    <td colspan='2'>Disp ENG.</td>                                                    <td colspan='2'>Emb ENG.</td>                                                    <td colspan='2'>Closed ENG.</td>                                                    <td colspan='2'>ENG. Att</td>                                                    <td colspan='2'>Time on page</td>                                                    <td>ERR</td>                                                    <td>WARN</td>                                                    <td>OK</td>                                                </tr>                                                <tr class='LEImainTableNumberRow'><td style='height:5px'></td></tr>                                            </tbody>                                        </table>                                    </td>                                </tr>                                <tr id='LEIMainLogWindow'>                                    <td>                                        <table id='LEIMainLogWindowTable' width='100%' cellspacing='0' cellpadding='0' border='0'>                                            <tbody>                                                <tr id='LEIMessageWindowHeader'>                                                    <td id='LEIMessageWindowTitle'></td>                                                    <td id='LEIMessageWindowCtrlPanel'>                                                        </td>                                                    <td id='LEIMessageWindowClose' align='right'>                                                        <div style='float:right'><a href='javascript:;'>                                                            <div id='LEIImgCloseLog' border='0'></div>                                                        </a></div>                                                    </td>                                                </tr>                                                <tr id='LEIFilterRow' style='display:none;'>                                                    <td  colspan='3'>                                                        <div id='LEIFilterWindow'>FILTER GOES HERE</div>                                                    </td>                                                </tr                                                <tr>                                                    <td  colspan='3'>                                                        <div id='LEILogWindow'></div>                                                    </td>                                                </tr                                            </tbody>                                        </table>                                    </td>                                </tr>                                <tr>                                    <td>                                        <table id='LEIMainStatusTable' height='20px' width='100%' cellspacing='0' cellpadding='0' border='0'>                                            <tbody>                                                <tr  class='LEIStatusBar'>                                                    <td><div id='LEITagStatIcon' class='LEITagStatNotFound'></div></td>                                                    <td id='LEITagStatText'>Tag not found.</div></td>                                                    <td >Ver :</td>                                                    <td id='LEILPTAGver'>"+this.noValueStr+"</td>                                                    <td >/</td>                                                    <td id='LEITAGver'>"+this.noValueStr+"</td>                                                    <td >Tag Load Time:</td>                                                    <td id='LEILoadTime'>"+this.noValueStr+"</td>                                                    <td></td>                                                    <td></td>                                                    <td></td>                                                    <td></td>                                                    <td></td>                                                    <td class='LEIStatusDivider'></td>                                                    <td id='LEIStatusImageTD'><div id='LEIStatusImage'>OK</div></td>                                                    <td class='LEIStatusDivider'></td>                                                    <td id='LEIMsgStatusLogPlayerStatus'>Log Active</td>                                                    <td class='LEIStatusDivider'></td>                                                    <td class='LEIStatusDivider'></td>                                                    <td id='LEIStatusResize' class='LEIStatusResize'></td>                                                </tr>                                            </tbody>                                        </table>                                    </td>                                </tr>                            </tbody>                        </table>",this.emtHtml},this.getMaxZindex=function(){for(var t=document.getElementsByTagName?document.getElementsByTagName("*"):document.all,e=0,i=0;i<t.length;i++){var o=t[i],n=null;o.currentStyle?n=o.currentStyle:document.defaultView&&document.defaultView.getComputedStyle&&(n=document.defaultView.getComputedStyle(o,""));var s;s=n?Number(n.zIndex):Number(o.style.zIndex),isNaN(s)||(e=Math.max(e,s))}return e},this.addCss=function(){var t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode(this.css)),document.getElementsByTagName("head")[0].appendChild(t)},this.createGenericDiv=function(t,e,i,o,n,s,a,l,r,d,g){if(document.getElementsByTagName){var h=document.getElementsByTagName("body");if(h&&null==this.GetObj(t)){var p=document.createElement("div");p.setAttribute("id",t),p.setAttribute("name",t),p.style.zIndex=e,p.style.position="absolute",p.style.visibility=d?"visible":"hidden",p.style.left=i+"px",p.style.top=o+"px",null!=n&&(p.style.height=n+"px"),null!=s&&(p.style.width=s+"px"),p.innerHTML=a,p.style.cssText=p.style.cssText+g+"height:"+n+";",null!=l&&(p.style.cursor=l),null!=r&&(p.onclick=r),null!=document.body.firstChild?document.body.insertBefore(p,document.body.firstChild):h.appendChild(p)}}},this.GetObj=function(t){return document.getElementById?document.getElementById(t):document.all?document.all(t):void 0},this.BrowserSniff=function(){if(document.layers)return"NS";var t=navigator.userAgent.toLowerCase();if(document.all){var e=-1!=t.indexOf("opera"),i=-1!=t.indexOf("konqueror");return e?"OPR":i?"KONQ":"IE"}if(document.getElementById){var o=-1!=t.indexOf("firefox");return o?"FF":"MOZ"}return"OTHER"},this.attachEvents=function(){var t=this.GetObj("LEIMainTitle"),e=this;t.onmousedown=function(t){e.DragStart("LEImainDiv",t)},t=this.GetObj("LEIImgMinimize"),t.onclick=function(){e.minimizeAll()},t=this.GetObj("LEIImgClose"),t.onclick=function(){e.closeWindow()},t=this.GetObj("LEIToggleLog"),t.onclick=function(){e.toggleLog()},t=this.GetObj("LEIImgCloseLog"),t.onclick=function(){e.minimizeMsgDiv()},this.msgShown?(t=this.GetObj("LEIStatusResize"),t.className="LEIStatusResize",t.onmousedown=function(t){e.resizeStart("LEILogWindow",t)}):(t=this.GetObj("LEIStatusResize"),t.className="LEIStatusNOResize")},this.engagementLeChatInfo=function(t,e){var i=e?this.leChatRef.inPagePluginsArr:this.leChatRef.jsonsArr,o="";this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog(),this.leChatRef||"undefined"==typeof i||(o="NO engagements defined"),o="<table>";for(var n in i)i[n].type===t&&(o+="<tr><td>"+this.objectToString(i[n],void 0,!0,"LEIGeneralInfoNoBorder",!0)+"</tr>",o+="<tr><td>----------------------------------------------------------</td></tr>");return o+="</table>",this.showMsgWindow(!1,"Engagement Info",o,{width:400,height:100}),!1},this.dispEngInfo=function(){this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog();var t="";if(t='<table>        			<tr>        				<td class="LEILable" width="10%">No.</td>        				<td class="LEILable" width="20%">Campaign ID</td>        				<td class="LEILable">Engagement ID</td>        			</tr>',this.store.impDisplay.length>0)for(var e=this.store.impDisplay,i=0;i<e.length;i++)"object"==typeof e[i]&&(t+="<tr>	                			<td>"+(i+1)+"</td>",t+="	<td>"+e[i].campaign+"</td>",t+="   <td>"+e[i].engId+"</td>	                		 </tr>");return t+="</table>",this.showMsgWindow(!1,"Displayed Engagement Info",t,{width:500,height:100}),!1},this.closedEngInfo=function(){this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog();var t="";if(t='<table>        			<tr>        				<td class="LEILable" width="10%">No.</td>        				<td class="LEILable" width="20%">Campaign ID</td>        				<td class="LEILable">Engagement ID</td>        			</tr>',this.store.impClose.length>0)for(var e=this.store.impClose,i=0;i<e.length;i++)"object"==typeof e[i]&&(t+="<tr>	                			<td>"+(i+1)+"</td>",t+="	<td>"+e[i].campaign+"</td>",t+="   <td>"+e[i].engId+"</td>	                		 </tr>");return t+="</table>",this.showMsgWindow(!1,"Displayed Engagement Info",t,{width:500,height:100}),!1},this.dispEngAtt=function(){this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog();var t="";if(t='<table>        			<tr>        				<td class="LEILable" width="10%">No.</td>        				<td class="LEILable" width="30%">Engagement Attributes</td>        				<td class="LEILable"># Atts</td>        			</tr>',this.store){var e=0;for(name in this.store)"impDisplay"!=name&&"impClose"!=name&&"pagediv"!=name&&"tabActive"!=name&&(t+="<tr>	                			<td>"+ ++e+"</td>",t+="	<td>"+name+"</td>",t+="   <td>"+this.store[name].length+"</td>	                		 </tr>")}return t+="</table>",this.showMsgWindow(!1,"Engagement Attributes",t,{width:500,height:100}),!1},this.dispEMBInfo=function(){this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog();var t="";if(t='<table>        			<tr>        				<td class="LEILable" width="10%">No.</td>        				<td class="LEILable" width="20%">Div ID</td>        				<td class="LEILable"></td>        			</tr>',this.store.pagediv.length>0)for(var e=this.store.pagediv,i=0;i<e.length;i++)"object"==typeof e[i]&&(t+="<tr>	                			<td>"+(i+1)+"</td>",t+="	<td>"+e[i].divId+"</td>",t+="	<td></td></tr>");return t+="</table>",this.showMsgWindow(!1,"Embedded Engagement Info",t,{width:500,height:100}),!1},this.clearCompactSnippetMode=function(){return this.toggleTools(),this.GetCookie(this.debugCookieName)==this.debugCookieValue?this.DeleteCookie(this.debugCookieName,"/"):this.SetCookie(this.debugCookieName,this.debugCookieValue,null,"/"),!1},this.toggleViewMode=function(t){var e=lpMTagDebug.GetObj("LEIObjectInfo-"+t);return null!=e&&("none"==e.style.display||""==e.style.display?e.style.display="block":e.style.display="none"),!1},this.objectToString=function(t,e,i,o,n){"undefined"==typeof e&&(e=","),"undefined"==typeof i&&(i=!1),"undefined"==typeof n&&(n=!1);var s,a="";s=i?"<table class='"+o+"'>":"{";var l=!0;for(var r in t){l?l=!1:i||(a+=e);var d="";if(null!=t[r]&&"undefined"!=typeof t[r].constructor&&(d="undefined"!=typeof t[r].constructor.name?t[r].constructor.name:0==t[r].constructor.toString().indexOf("function")?"function":t[r].constructor.toString()),n&&"object"==typeof t[r]&&null!=t[r]&&"undefined"!=typeof t[r].constructor&&t[r].constructor!=Image&&t[r].constructor!=Date&&-1==d.indexOf("HTML"))if(i){var g=this.evalToolCnt++,h=this.objectToString(t[r],e,i,o,n);a+=""!=h?"<tr><th><a href=javascript:; onclick='lpMTagDebug.toggleViewMode("+g+")'>"+r+"</a></th><td id='LEIObjectInfo-"+g+"' class='LEIHiddenTD'>"+h+"</td>":"<tr><th>"+r+"</th><td id='LEIObjectInfo-"+g+"'>"+h+"</td>"}else a+="'"+r+"':'"+this.objectToString(t[r],e,i,o,n)+"'";else{var p=null==t[r]?"":t[r].toString();p=p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),a+=i?"<tr><th>"+r+"</th><td>"+p+"</td>":"'"+r+"':'"+p+"'"}}return""!=a&&(a=s+a,a+=i?"</table>":"}"),a},this.logPlayer=function(t){var e,i=this;switch(t){case this._LOG_TRASH:this.log=[],this.clearLogDisplay();break;case this._LOG_PLAY:e=this.GetObj("LEILogPlay"),e.onclick=function(){i.logPlayer(i._LOG_PAUSE)},e=this.GetObj("LEILogPlayImg"),e.src=this.baseURL+"images/pause.png",e=this.GetObj("LEIMsgStatusLogPlayerStatus"),e.innerHTML="Log Active",this.logStatus=t,this.clearLogDisplay(),this.displayFullLog(this.log);break;case this._LOG_PAUSE:e=this.GetObj("LEILogPlay"),e.onclick=function(){i.logPlayer(i._LOG_PLAY)},
e=this.GetObj("LEILogPlayImg"),e.src=this.baseURL+"images/play.png",e=this.GetObj("LEIMsgStatusLogPlayerStatus"),e.innerHTML="Log Paused",this.logStatus=t;break;case this._LOG_STOP:e=this.GetObj("LEILogPlay"),e.onclick=function(){i.logPlayer(i._LOG_PLAY)},e=this.GetObj("LEILogPlayImg"),e.src=this.baseURL+"images/play.png",e=this.GetObj("LEIMsgStatusLogPlayerStatus"),e.innerHTML="Log Stopped",this.logStatus=t}return!1},this.toggleLog=function(){this.toolsShown&&this.toggleTools();var t=this;if(this.logShown)this.logShown=!1,this.hideMsgWindow();else{this.logShown=!0;var e="<div id='LEILogToggleTime' class='LEITimeIcon'></div><div id='LEILogToggleFilter' class='LEIFilterIcon'></div><div class='LEILogTitle'>EMT Log</div>";this.showMsgWindow(!0,e);var i=this.GetObj("LEILogToggleTime");i.onclick=function(){return t.toggleLogTime(),!1};var i=this.GetObj("LEILogToggleFilter");i.onclick=function(){return t.toggleLogFilter(),!1},this.displayFullLog(this.log)}return this.resizeShowHideImage(),!1},this.toggleLogFilter=function(){if(this.showLogFilter=!this.showLogFilter,this.showLogFilter){var t="<table><tr>",e=[];e[0]="",e[1]="";var i=0;for(var o in this.msgSources)if("object"==typeof this.msgSources[o]&&this.msgSources[o].source){for(var n="",s=0;s<this.activeFilter.length;s++)if(o==this.activeFilter[s]){n="checked";break}e[i]+='<input name="LEIFilterChoice" value="'+o+'" type="checkbox" '+n+">"+o+"</input><br>",i=0==i?1:0}t+="<td>"+e[0]+"</td>",t+="<td>"+e[1]+"</td>",t+="<td align='center'><a id='LEILogToggleFilterApply' href=javascript:;><img src='"+this.baseURL+"images/apply.png' border='0'/></td></a>",t+="<td align='center'><a id='LEILogToggleFilterCancel' href=javascript:;><img src='"+this.baseURL+"images/cancel.png' border='0'/></td></a>",t+="</tr></table>";var a=this.GetObj("LEIFilterWindow");if(null!=a){a.innerHTML=t;var l=this,r=this.GetObj("LEILogToggleFilterApply");r.onclick=function(){return l.logFilterApply(),!1},r=this.GetObj("LEILogToggleFilterCancel"),r.onclick=function(){return l.logFilterCancel(),!1}}this.showObj("LEIFilterRow")}else this.hideObj("LEIFilterRow")},this.logFilterCancel=function(){this.showLogFilter=!this.showLogFilter,this.activeFilter=[],this.hideObj("LEIFilterRow"),this.displayFullLog(this.log)},this.logFilterApply=function(){this.showLogFilter=!this.showLogFilter,this.activeFilter=[],this.hideObj("LEIFilterRow");for(var t=document.getElementsByName("LEIFilterChoice"),e=0;e<t.length;e++)t[e].checked&&(this.activeFilter[this.activeFilter.length]=t[e].value);this.displayFullLog(this.log)},this.toggleLogTime=function(){return this.showTimeinLog=!this.showTimeinLog,this.displayFullLog(this.log),!1},this.hideMsgWindow=function(){this.msgShown=!1,this.logShown&&(this.logShown=!1),this.hideObj("LEIMainLogWindow",!0),this.GetObj("LEILogWindow").innerHTML="",this.resizeShowHideImage()},this.showMsgWindow=function(t,e,i,o){this.msgShown=!0,this.resizeShowHideImage(),this.showTR("LEIMainLogWindow"),this.showObj("LEIMainLogWindow",!1);var n;if("undefined"!=typeof t&&t){this.GetObj("LEIMessageWindowCtrlPanel").innerHTML=this.logCtrlPanelHTML;var s=this;n=this.GetObj("LEILogPlay"),n.onclick=function(){s.logPlayer(s._LOG_PAUSE)},n=this.GetObj("LEILogStop"),n.onclick=function(){s.logPlayer(s._LOG_STOP)},n=this.GetObj("LEILogErase"),n.onclick=function(){s.logPlayer(s._LOG_TRASH)}}else this.GetObj("LEIMessageWindowCtrlPanel").innerHTML="";e&&(this.GetObj("LEIMessageWindowTitle").innerHTML=e),i&&(this.GetObj("LEILogWindow").innerHTML=i),"undefined"==typeof o||this.resized||(n=this.GetObj("LEILogWindow"),o.width&&(n.style.width="100%"),o.height&&(n.style.height=o.height+"px"),n.style.overflow="auto")},this.toggleTools=function(){if(this.toolsShown)this.toolsShown=!1,this.hideObj("LEIToolsDiv");else{this.toolsShown=!0;var t;"undefined"!=typeof lpMTag&&(t=this.GetObj("LEIStopStartEMT"),lpMTag.stopMTag?t.innerHTML="Start EMT":t.innerHTML="Stop EMT"),"undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.lpServer||"undefined"==typeof lpMTagConfig.lpNumber?this.hideObj("LEIAdminArea"):this.showObj("LEIAdminArea");var e=this.getElWidthHeight("LEIToggleTools","LEImainDiv");t=this.GetObj("LEIToolsDiv"),t.style.left=e.ul.x+"px",t.style.top=e.br.y+3+"px",this.showObj("LEIToolsDiv")}return!1},this.updateConfig=function(){var t=this,e=!1;if("undefined"!=typeof lpMTag&&(elem=this.GetObj("LEITagStatIcon"),"LEITagStatWarn"!=elem.className&&(e=!0,elem.className="LEITagStatWarn",elem=this.GetObj("LEITagStatText"),elem.innerHTML="Old monitor tag")),"undefined"!=typeof lpTag){elem=this.GetObj("LEITagStatIcon"),"LEITagStatOk"!=elem.className&&void 0!=lpTag.site&&(elem.className="LEITagStatOk",e=!0,elem=this.GetObj("LEITagStatText"),elem.innerHTML="Tag detected.");var i=new Date,o=new Date;this.timestart=lpTag._timing.contReady>0?new Date(lpTag._timing.contReady):this.timestart;var n=i.getTime()-this.timestart.getTime();o.setTime(n);var s=o.getUTCMinutes()>0?o.getUTCMinutes()+"m ":"",a=o.getUTCHours()>0?o.getUTCHours()+"h ":"",l=o.getUTCSeconds()+"s",r=a+s+l;elem=this.GetObj("LEIStatusTimeOnPage"),elem.innerHTML=r;var d=lpTag.site||"Not Found";this.store="function"==typeof lpTag.sdes.inspect?lpTag.sdes.inspect().store:{},elem=this.GetObj("LEIEMTsiteId"),elem.innerHTML!=d&&(e=!0,elem.innerHTML=d);var g=0;for(name in this.store)"impDisplay"!=name&&"impClose"!=name&&"pagediv"!=name&&"tabActive"!=name&&g++;g>0&&(elem=this.GetObj("LEIENGAtt"),elem.innerHTML=g,elem.style.cursor="pointer",elem.onclick=function(){t.dispEngAtt()});var h="function"==typeof lpTag.getDomain?lpTag.getDomain():this.noValueStr;elem=this.GetObj("LEIDomain"),elem.innerHTML!=h&&"undefined"!=h&&(e=!0,elem.innerHTML=h),""!=lpTag.section&&(elem=this.GetObj("LEIEMTSection"),e=!0,elem.innerHTML=lpTag.section);var p=this.store.impDisplay;if("undefined"!=typeof p){var u=p.length;elem=this.GetObj("LEIENGcnt"),elem.innerHTML!=u&&(e=!0,elem.innerHTML=u,elem.onclick=function(){t.dispEngInfo()},elem.className="emtDebugInfo")}var c=this.store.pagediv;if("undefined"!=typeof c){var m=c.length;elem=this.GetObj("LEIEMBcnt"),elem.innerHTML!=m&&(e=!0,elem.innerHTML=m,elem.onclick=function(){t.dispEMBInfo()},elem.className="emtDebugInfo")}var f=this.store.impClose;if("undefined"!=typeof f){var u=f.length;elem=this.GetObj("LEIClosedcnt"),elem.innerHTML!=u&&(e=!0,elem.innerHTML=u,elem.onclick=function(){t.closedEngInfo()},elem.className="emtDebugInfo")}elem=this.GetObj("LEILoadTime");var L=lpTag._timing.start||0,b=lpTag._timing.contReady||0,E=b-L>0?b-L:"N/A";elem.innerHTML===this.noValueStr&&(e=!0,elem.innerHTML=E+"ms"),this.leChatRef="undefined"!=typeof lpTagConfig&&"undefined"!=typeof lpTagConfig.tagPlugins?lpTagConfig.tagPlugins:null,this.leChatProps.ver="undefined"!=typeof lpTagConfig?" ("+lpTagConfig._ver+")":"";var I="undefined"!=typeof lpTag?lpTag._v:this.noValueStr;elem=this.GetObj("LEILPTAGver"),elem.innerHTML!=I&&(e=!0,elem.innerHTML=I);var T="undefined"!=typeof lpTag?lpTag._tagv:this.noValueStr;elem=this.GetObj("LEITAGver"),elem.innerHTML!=T&&(e=!0,elem.innerHTML=T),this.counters.logOK>0&&(elem=this.GetObj("LEIOKcnt"),elem.innerHTML!=this.counters.logOK&&(e=!0,elem.innerHTML=this.counters.logOK),elem.className="emtDebugOK"),this.counters.logWarn>0&&(elem=this.GetObj("LEIWARNcnt"),elem.innerHTML!=this.counters.logWarn&&(e=!0,elem.innerHTML=this.counters.logWarn),elem.className="emtDebugWarn",elem.onclick=function(){t.logShowErrWarn("warn")},0==this.counters.logErr&&(elem=this.GetObj("LEIStatusImage"),elem.innerHTML="Warning",elem.style.cursor="pointer",elem.onclick=function(){t.maximizeAll(),t.logShowErrWarn("warn")})),this.counters.logErr>0&&(elem=this.GetObj("LEIERRcnt"),elem.innerHTML!=this.counters.logErr&&(e=!0,elem.innerHTML=this.counters.logErr),elem.className="emtDebugError",elem.onclick=function(){t.logShowErrWarn("error")},elem=this.GetObj("LEIStatusImage"),elem.innerHTML="Error",elem.style.cursor="pointer",elem.onclick=function(){t.maximizeAll(),t.logShowErrWarn("error")})}this.timerRef=setTimeout(function(){t.updateConfig()},1e3*this.timerPeriod)},this.minimizeAll=function(){var t=this;this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog(),this.hideObj("LEIMonitorWindow"),this.hideObj("LEIMainLogWindow");var e=this.GetObj("LEIImgMinimize");return e.className="LEIMaxBtn",e.onclick=function(){t.maximizeAll()},!1},this.closeWindow=function(){var t=document.body,e=document.getElementById("LEImainDiv");t.removeChild(e)},this.showTR=function(t){"IE"==this.browser?this.GetObj(t).style.display="block":this.GetObj(t).style.display="table-row",this.showObj(t,!1)},this.maximizeAll=function(){var t=this;this.showTR("LEIMonitorWindow");var e=this.GetObj("LEIImgMinimize");return e.className="LEIMiniBtn",e.onclick=function(){t.minimizeAll()},!1},this.minimizeMsgDiv=function(){return this.hideMsgWindow(),!1},this.resizeShowHideImage=function(){var t=this.GetObj("LEIStatusResize");if(this.msgShown){var e=this;t.className="LEIStatusResize",t.onmousedown=function(t){e.resizeStart("LEILogWindow",t)}}else t.className="LEIStatusNOResize",t.onmousedown=null},this.resizeObj=null,this.resized=!1,this.resizeStart=function(t,e){if(!this.msgShown)return!1;if(this.resizeObj=this.GetObj(t),null==this.resizeObj)return void alert("NO resize Object:"+t);this.resized=!0;var i,o;return"IE"==this.browser?(i=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,o=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop):(i=e.clientX+window.scrollX,o=e.clientY+window.scrollY),this.resizeCursorStartX=i,this.resizeCursorStartY=o,this.resizeElStartDimen=this.getElWidthHeight(t),"IE"==this.browser?(document.attachEvent("onmousemove",lpMTagDebug.resizeGo),document.attachEvent("onmouseup",lpMTagDebug.resizeStop),window.event.cancelBubble=!0,window.event.returnValue=!1):(document.addEventListener("mousemove",lpMTagDebug.resizeGo,!0),document.addEventListener("mouseup",lpMTagDebug.resizeStop,!0),e.preventDefault()),!1},this.resizeGo=function(t){var e,i;"IE"==lpMTagDebug.browser?(e=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,i=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop):(e=t.clientX+window.scrollX,i=t.clientY+window.scrollY);var o=lpMTagDebug.resizeElStartDimen.width+(e-lpMTagDebug.resizeCursorStartX),n=lpMTagDebug.resizeElStartDimen.height+(i-lpMTagDebug.resizeCursorStartY);o>=0&&(lpMTagDebug.resizeObj.style.width=o+"px"),n>=0&&(lpMTagDebug.resizeObj.style.height=n+"px");var s=lpMTagDebug.getElWidthHeight("LEIMainLogWindow");return o<s.width&&o>=0&&(lpMTagDebug.resizeObj.style.width=s.width+"px"),!1},this.resizeStop=function(){return"IE"==lpMTagDebug.browser?(document.detachEvent("onmousemove",lpMTagDebug.resizeGo),document.detachEvent("onmouseup",lpMTagDebug.resizeStop)):(document.removeEventListener("mousemove",lpMTagDebug.resizeGo,!0),document.removeEventListener("mouseup",lpMTagDebug.resizeStop,!0)),!1},this.getElWidthHeight=function(t,e){var i=this.GetObj(t);if(null==i)return alert("Error getting the element:"+t),!1;var o={};o.x=i.offsetLeft,o.y=i.offsetTop;for(var n=i.offsetParent;n&&n.id!=e&&"BODY"!=n.tagName.toUpperCase();)o.x+=n.offsetLeft,o.y+=n.offsetTop,n=n.offsetParent;var s={};return s.x=o.x+i.offsetWidth,s.y=o.y+i.offsetHeight,{width:s.x-o.x,height:s.y-o.y,ul:o,br:s}},this.dragObj=null,this.DragStart=function(t,e){if(this.toolsShown&&(this.hideObj("LEIToolsDiv"),this.toolsShown=!1),this.dragObj=this.GetObj(t),null==this.dragObj)return void alert("NO drag Object");var i,o;return"IE"==this.browser?(i=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,o=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop):(i=e.clientX+window.scrollX,o=e.clientY+window.scrollY),this.dragCursorStartX=i,this.dragCursorStartY=o,this.dragElStartLeft=parseInt(this.dragObj.style.left,10),this.dragElStartTop=parseInt(this.dragObj.style.top,10),isNaN(this.dragElStartLeft)&&(this.dragElStartLeft=0),isNaN(this.dragElStartTop)&&(this.dragElStartTop=0),"IE"==this.browser?(document.attachEvent("onmousemove",lpMTagDebug.dragGo),document.attachEvent("onmouseup",lpMTagDebug.dragStop),window.event.cancelBubble=!0,window.event.returnValue=!1):(document.addEventListener("mousemove",lpMTagDebug.dragGo,!0),document.addEventListener("mouseup",lpMTagDebug.dragStop,!0),e.preventDefault()),!1},this.dragGo=function(t){var e,i;"IE"==lpMTagDebug.browser?(e=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,i=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop):(e=t.clientX+window.scrollX,i=t.clientY+window.scrollY);var o=lpMTagDebug.dragElStartLeft+e-lpMTagDebug.dragCursorStartX;1>o&&(o=1);var n=lpMTagDebug.dragElStartTop+i-lpMTagDebug.dragCursorStartY;return 1>n&&(n=1),lpMTagDebug.dragObj.style.left=o+"px",lpMTagDebug.dragObj.style.top=n+"px","IE"==lpMTagDebug.browser?(window.event.cancelBubble=!0,window.event.returnValue=!1):t.preventDefault(),!1},this.dragStop=function(){return"IE"==lpMTagDebug.browser?(document.detachEvent("onmousemove",lpMTagDebug.dragGo),document.detachEvent("onmouseup",lpMTagDebug.dragStop)):(document.removeEventListener("mousemove",lpMTagDebug.dragGo,!0),document.removeEventListener("mouseup",lpMTagDebug.dragStop,!0)),!1},this.hideObj=function(t,e){"undefined"==typeof e&&(e=!0);var i=this.GetObj(t);null!=i&&(i.style.visibility="hidden",e&&(i.style.display="none"))},this.showObj=function(t,e){"undefined"==typeof e&&(e=!0);var i=this.GetObj(t);null!=i&&(i.style.visibility="visible",e&&(i.style.display="block"))},this.Display=function(t,e,i){if(t.indexOf("Garbage Collection")>-1){if(this.garbColStrCnt++,10==this.garbColStrCnt)t="PAUSING LOG DISPLAY",e="WARN";else if(this.garbColStrCnt>10)return}else this.garbColStrCnt=0;t.indexOf("GET")>-1&&this.counters.connGET++,t.indexOf("POST")>-1&&this.counters.connPOST++;var o,n,s;if(t.indexOf("EVENT")>-1)if(t.indexOf("DynBut")>-1){var a=null;if(o=null,n=t.indexOf("lpMTagConfig.dynButton"),-1!=n&&(o=n+"lpMTagConfig.dynButton".length,a=parseInt(t.substr(o),10)),null==a){n=t.indexOf("DynBut")+"DynBut ".length;for(var l=t.substring(n,t.indexOf("EVENT")-1),r=0;r<lpMTagConfig.dynButton.length;r++)if(lpMTagConfig.dynButton[r].name==l){a=r;break}}s=t.substr(t.indexOf("EVENT")+" EVENT:".length),"undefined"==typeof this.eventLog.dynButton["but"+a]&&(this.eventLog.dynButton["but"+a]=[]),this.eventLog.dynButton["but"+a][this.eventLog.dynButton["but"+a].length]=s}else if(t.indexOf("lpMTagConfig.invite")>-1){n=t.indexOf("lpMTagConfig.invite"),o=n+"lpMTagConfig.invite".length;var d=parseInt(t.substr(o),10);isNaN(d)&&(o=n+"lpMTagConfig.inviteMC".length,d=parseInt(t.substr(o),10)),s=t.substr(o+d.toString().length+" EVENT: ".length),"undefined"==typeof this.eventLog.invite["inv"+d]&&(this.eventLog.invite["inv"+d]=[]),this.eventLog.invite["inv"+d][this.eventLog.invite["inv"+d].length]=s}"ERROR"==e?this.counters.logErr++:"EXEC-OK"==e?this.counters.logOK++:"WARN"==e?this.counters.logWarn++:this.counters.logOK++,this.counters.logLine++,this.log.length==this.logMaxLines&&this.log.shift();var g=new Date,h=g.getHours(),p=g.getMinutes(),u=g.getSeconds();10>h&&(h="0"+h),10>p&&(p="0"+p),10>u&&(u="0"+u);var c=h+":"+p+":"+u;"undefined"==typeof i&&(i="Not specified");var m={msg:t,time:c,level:e,source:i};"undefined"==typeof this.msgSources[i]&&(this.msgSources[i]={source:i}),"ERROR"==e?this.logErr[this.logErr.length]=m:"WARN"==e&&(this.logWarn[this.logWarn.length]=m),this.logStatus!=this._LOG_STOP&&(this.log[this.log.length]=m,this.logShown&&this.logStatus!=this._LOG_PAUSE&&this.printLogLine(m))},this.displayFullLog=function(t){this.clearLogDisplay();for(var e=0;e<t.length;e++)this.printLogLine(t[e])},this.clearLogDisplay=function(){var t=this.GetObj("LEILogWindow");t.innerHTML=""},this.logShowErrWarn=function(t){this.logShown&&this.toggleLog(),this.toolsShown&&this.toggleTools();var e;if("warn"==t)e=this.logWarn;else{if("error"!=t)return void alert("wrong logType="+t);e=this.logErr}return this.showMsgWindow(!1,"Error Messages from Log !!!Not updated Live!!!","",{width:400,height:this.maxLogWindowMaxHeight}),this.displayFullLog(e),!1},this.printLogLine=function(t){var e=!0;if(this.activeFilter.length>0){e=!1;for(var i=0;i<this.activeFilter.length;i++)if(t.source==this.activeFilter[i]){e=!0;break}if(!e)return}var o="";o="ERROR"==t.level?"LEILogMessageERROR":"EXEC-OK"==t.level?"LEILogMessageOK":"WARN"==t.level?"LEILogMessageWARN":"LEILogMessageDEBUG";var n=this.GetObj("LEILogWindow"),s=document.createElement("div");s.id="mtagTextDiv-"+this.counters.logLine,s.className=o,s.innerHTML=(this.showTimeinLog?t.time+" ":" ")+t.msg,null!=n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s);var a,l=this.getElWidthHeight("LEILogWindow");!this.resized&&l.height>this.maxLogWindowMaxHeight&&(a=this.GetObj("LEILogWindow"),a.style.height=this.maxLogWindowMaxHeight+"px",this.logWindowDimensionLimited||(a.style.width=l.width+15+"px"),a.style.overflow="auto",this.logWindowDimensionLimited=!0),!this.resized&&l.width>this.maxLogWindowMaxWidth&&(a=this.GetObj("LEILogWindow"),a.style.width=this.maxLogWindowMaxWidth+"px",a.style.overflow="auto",this.logWindowDimensionLimited=!0)},this.getUdes=function(){"undefined"!=typeof lpMTagConfig&&(this.ude.page=lpMTagConfig.pageVar,this.ude.session=lpMTagConfig.sessionVar,this.ude.visitor=lpMTagConfig.visitorVar)},this.showUdes=function(){this.logShown&&this.toggleLog(),this.toolsShown&&this.toggleTools();var t="<b>Page UDEs</b><br />";return t+=this.objectToString(this.ude.page,void 0,!0,"LEIGeneralInfo",!1),t+="<br /><b>Session UDEs</b>",t+=this.objectToString(this.ude.session,void 0,!0,"LEIGeneralInfo",!1),t+="<br /><b>Visitor UDEs</b>",t+=this.objectToString(this.ude.visitor,void 0,!0,"LEIGeneralInfo",!1),this.showMsgWindow(!1,"UDEs at page start",t,{width:400,height:this.maxLogWindowMaxHeight}),!1},this.DisplayArray=function(t,e){for(var i=0;i<t.length;i++){var o=t[i].split("<!!>");this.Display(o[0],o[1],e)}},this.GetPageWidth=function(){return document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:window.innerWidth},this.SetCookie=function(t,e,i,o,n,s){var a=new Date,l=a.getTime();"undefined"!=typeof i&&null!=i||(i=1e3*i*60*60*24,l=a.getTime()+i),document.cookie=t+"="+escape(e)+(i?";expires="+l.toGMTString():"")+(o?";path="+o:"")+(n?";domain="+n:"")+(s?";secure":"")},this.DeleteCookie=function(t,e,i){this.GetCookie(t)&&(document.cookie=t+"="+(e?";path="+e:"")+(i?";domain="+i:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT")},this.GetCookie=function(t){var e=document.cookie.indexOf(t+"="),i=e+t.length+1;if(!e&&t!=document.cookie.substring(0,t.length))return null;if(-1==e)return null;var o=document.cookie.indexOf(";",i);return-1==o&&(o=document.cookie.length),unescape(document.cookie.substring(i,o))},this.start=function(){var t=this;"undefined"!=typeof lpMTagConfig&&"undefined"!=typeof lpMTagConfig.emtDebugZindex||(this.zindex=this.getMaxZindex()+1),this.getUdes(),this.browser=this.BrowserSniff(),this.addCss(),this.generateHTML(),this.createGenericDiv("LEImainDiv",this.zindex,this.posX,this.posY,null,null,this.emtHtml,null,null,0),"undefined"!=typeof lpMTagConfig&&"undefined"!=typeof lpMTagConfig.emtDebugPosRight&&lpMTagConfig.emtDebugPosRight&&(this.posX=this.GetPageWidth()-this.GetObj("LEImainDiv").clientWidth-30),this.GetObj("LEImainDiv").style.left=this.posX+"px",this.showObj("LEImainDiv",!1),this.attachEvents(),"undefined"!=typeof lpMTagConfig&&"undefined"!=typeof lpMTagConfig.emtDebugSuperMiniMode&&lpMTagConfig.emtDebugSuperMiniMode&&this.minimizeAll(),this.timerRef=setTimeout(function(){t.updateConfig()},500)}}var lpMTagDebug=new LEI;lpMTagDebug.start();